{"_id":"_design/photos","_rev":"6-8de85f2e9a4671c53c885191dda717f9","language":"javascript","views":{"by_association":{"map":"function(doc) { for(var i=0; i<doc.associations.length; i++) { emit(doc.associations[i].association, doc); } }"},"conflict_docs":{"map":"function(doc) { if (doc._conflicts) { emit(doc._id, [doc._rev].concat(doc._conflicts)); } }"}},"updates":{"add_association":"function(doc, req) { if (!doc){ var er; er.message = 'missing'; return [null, JSON.stringify(er)];} var jOb = JSON.parse(req.body); for(var i=0; i<jOb.associations.length; i++){ var ins=true; for(var k = 0; k<doc.associations.length; k++){ if(doc.associations[k].association == jOb.associations[i].association && doc.associations[k].author == jOb.associations[i].author) ins=false;} if(ins) doc.associations.push(jOb.associations[i]);} return [doc,  JSON.stringify(doc)];}"}}
